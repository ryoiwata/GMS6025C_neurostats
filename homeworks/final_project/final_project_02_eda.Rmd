---
title: "Final Project"
author: "Emely Gazarov, Ryo Iwata, Maria Ramirez"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidymodels)
library(knitr)
library(car)
# to control default number formatting, no need for specifying digits in kable.
options(scipen = 3, digits = 5) 
```

```{r}
all_addiction_data = read_rds("./addiction.rds")
```

```{r}
all_addiction_data
```

# Things that can predict
- number of sober days
- days since baseline
- age
- gender
- education
- drop out yes no
- SUD is alcholoc
- SUD is other
- Social support
  - family
  - friends
  - sig other
  - total
- Substance use history
  - Tried tobacco/alcohol
  - Age of first use
  - Regular use
  - Age of regular use
- AA/NA affiliation
  - Lifetime number of meetings
  - Last year number of meetings
  - Degree of affiliation
  - Positive thoughts
  - Negative thoughts
- Stressful life
  - happened
  - witnessed
  - learned about
  - exposed
  - total of all things
- Childhood
- Religion
  - Religious affiliation
  - Positive
  - Negative
- Life quality

# Things we can predict
- impression change
- length of stay
- Life quality
- Commitment to change
- Cravings
  - baseline
  - baseline vs followup
- Impression of change

```{r}
filtered_alcohol_data <- all_addiction_data |>
  # Getting only the people that are addicted to alcohol
  filter(SUD.is_Alchohol == 1) |>
  filter(SUD.is_sum == 1) 

filtered_alcohol_data

filtered_cocaine_data <- all_addiction_data |>
  # Getting only the people that are addicted to alcohol
  filter(SUD.is_Cocaine == 1)

filtered_cocaine_data

```

```{r}
filtered_alcohol_data |> ggplot(aes(abstain_confidence_pos_mean_baseline)) +
  geom_histogram()

filtered_alcohol_data |> ggplot(aes(abstain_confidence_neg_mean_baseline)) +
  geom_histogram()
```

```{r}
filtered_cocaine_data |> ggplot(aes(abstain_confidence_pos_mean_baseline)) +
  geom_histogram()

filtered_cocaine_data |> ggplot(aes(abstain_confidence_neg_mean_baseline)) +
  geom_histogram()

filtered_cocaine_data |> ggplot(aes(abstain_confidence_crv_mean_baseline)) +
  geom_histogram()

filtered_cocaine_data |> ggplot(aes(abstain_confidence_crv_mean_followup)) +
  geom_histogram()
```

```{r}
all_addiction_data |> ggplot(aes(impression_change_followup)) +
  geom_histogram()
```

```{r}
all_addiction_data |> ggplot(aes(social_support.total)) +
  geom_histogram() 

all_addiction_data |> ggplot(aes(social_support.fam_sub_total)) +
  geom_histogram() 

all_addiction_data |> ggplot(aes(social_support.friends_sub_total)) +
  geom_histogram() 

all_addiction_data |> ggplot(aes(social_support.sig_other_sub_total)) +
  geom_histogram() 
```
```{r}
all_addiction_data |> ggplot(aes(qol.general_health_baseline)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.psychological_health_baseline)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.physical_health_baseline)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.social_health_baseline)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.environmental_health_baseline)) +
  geom_histogram()
```

```{r}
all_addiction_data |> ggplot(aes(qol.general_health_followup)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.psychological_health_followup)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.physical_health_followup)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.social_health_followup)) +
  geom_histogram()

all_addiction_data |> ggplot(aes(qol.environmental_health_followup)) +
  geom_histogram()
```

```{r}
all_addiction_data |> ggplot(aes(commit_to_change.total)) +
  geom_histogram()
```